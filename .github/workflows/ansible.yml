name: PUBLISH TO ANSIBLE GALAXY

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  deploy:

    runs-on: ubuntu-latest

    steps:
    - name: deploy collection to ansible galaxy
      run: |
        ansible-galaxy collection build
        FILE=$(ls *.tar.gz)
        ansible-galaxy collection publish --token ${{ secrets.GALAXY_KEY }} $FILE
